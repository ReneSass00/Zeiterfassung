@using Zeiterfassung.Data
@using System.ComponentModel.DataAnnotations


@namespace Zeiterfassung.Components.Dialogs

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">Neues Projekt erstellen</MudText>
    </TitleContent>
    <DialogContent>
        <MudForm @ref="form" @bind-IsValid="@success" Model="newProject">
            <MudTextField @bind-Value="newProject.Name"
                          Label="Projektname"
                          Required="true"
                          RequiredError="Bitte geben Sie einen Namen an."
                          For="@(() => newProject.Name)" />

            <MudTextField @bind-Value="newProject.Description"
                          Label="Beschreibung (optional)"
                          Lines="3"
                          Class="mt-3"
                          For="@(() => newProject.Description)" />
        </MudForm>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Abbrechen</MudButton>
        <MudButton Color="Color.Primary" Variant="Variant.Filled" OnClick="Submit" Disabled="@(!success)">Speichern</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter]
    MudDialogInstance MudDialog { get; set; }

    private MudForm form;
    private bool success;

    // Ein leeres Projekt-Objekt für die Formularbindung
    private Project newProject = new();

    private void Submit()
    {
        // Validiert die Form und schließt den Dialog.
        // Das neue Projekt-Objekt wird als Ergebnis zurückgegeben.
        MudDialog.Close(DialogResult.Ok(newProject));
    }

    private void Cancel() => MudDialog.Cancel();
}